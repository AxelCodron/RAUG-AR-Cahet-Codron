import{ad as A,A as W,ae as C,af as E,v as B,ag as F,M as G,ac as H,W as O}from"./three.core-C4lmCis4.js";import{G as q,A as D,I}from"./three.examples-CRiElu58.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();let x,d,l,o,f,c,u=null,g=!1,v,L,P=!1,w=new H;const y=new q().setPath("/RAUG-AR-Cahet-Codron/assets/models/");x=document.createElement("div");document.body.appendChild(x);l=new A;d=new W(70,window.innerWidth/window.innerHeight,.01,20);const T=new C(16777215,12303359,3);T.position.set(.5,1,.25);l.add(T);o=new E({antialias:!0,alpha:!0});o.setPixelRatio(window.devicePixelRatio);o.setSize(window.innerWidth,window.innerHeight);o.setAnimationLoop(N);o.xr.enabled=!0;x.appendChild(o.domElement);document.body.appendChild(D.createButton(o,{requiredFeatures:["hit-test"]}));f=o.xr.getController(0);f.addEventListener("select",z);l.add(f);const p=new I(o,d);p.listenToXRControllerEvents(f);l.add(p);c=new B(new F(.15,.2,32).rotateX(-Math.PI/2),new G);c.matrixAutoUpdate=!1;c.visible=!1;l.add(c);window.addEventListener("resize",S);function S(){d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function j(s){const n=new O;return n.identity().extractRotation(s.matrixWorld),w.ray.origin.setFromMatrixPosition(s.matrixWorld),w.ray.direction.set(0,0,-1).applyMatrix4(n),w.intersectObjects(p.children,!0)}function b(s,n,i){c.matrix.decompose(s.position,s.quaternion,s.scale),s.scale.set(n,n,n),s.userData.type=i;const r=s.scene||s;switch(r.scale.set(n,n,n),r.userData.type=i,p.add(r),i){case"flask":v=!0;break;case"tube":L=!0;break;case"glassBottle":P=!0;break}}function z(s){if(c.visible){let r,e,t;v?L?P||y.load("glass-bottle.glb",a=>{r=a.scene,e=.04,t="glassBottle",b(r,e,t)}):y.load("tube.glb",a=>{r=a.scene,e=.1,t="tube",b(r,e,t)}):y.load("flask.glb",a=>{r=a.scene,e=.1,t="flask",b(r,e,t)})}const n=s.target,i=j(n);if(i.length>0){const e=i[0].object.parent.parent.parent.parent,t=e.scale.x;(e.userData.type==="flask"||e.userData.type==="tube"||e.parent.userData.type==="glassBottle")&&k(e,t)}n.userData.targetRayMode=s.data.targetRayMode}function k(s,n,i=3e3,r=100,e=.01){const t=performance.now();let a=t;function R(){const m=performance.now(),M=m-t;if(M<i){if(m-a>=r){a=m;const h=n+e*Math.sin(M/1e3*r*2*Math.PI);s.scale.set(h,h,h)}requestAnimationFrame(R)}else s.scale.set(n,n,n)}R()}function N(s,n){if(n){const i=o.xr.getReferenceSpace(),r=o.xr.getSession();if(g===!1&&(r.requestReferenceSpace("viewer").then(function(e){r.requestHitTestSource({space:e}).then(function(t){u=t})}),r.addEventListener("end",function(){g=!1,u=null}),g=!0),u){const e=n.getHitTestResults(u);if(e.length){const t=e[0];c.visible=!0,c.matrix.fromArray(t.getPose(i).transform.matrix)}else c.visible=!1}}o.render(l,d)}
//# sourceMappingURL=index-Bf0614BP.js.map
