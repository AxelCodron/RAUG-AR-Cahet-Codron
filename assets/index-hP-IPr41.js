import{ad as B,A as E,ae as G,af as D,v as H,ag as F,M as I,ac as z,W as N}from"./three.core-C4lmCis4.js";import{G as U,A as X,I as K}from"./three.examples-CRiElu58.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();let A,g,f,s,w,u,m=null,M=!1,C,O,W=!1,R=new z;const v=new U().setPath("/RAUG-AR-Cahet-Codron/assets/models/");A=document.createElement("div");document.body.appendChild(A);f=new B;g=new E(70,window.innerWidth/window.innerHeight,.01,20);const j=new G(16777215,12303359,3);j.position.set(.5,1,.25);f.add(j);s=new D({antialias:!0,alpha:!0});s.setPixelRatio(window.devicePixelRatio);s.setSize(window.innerWidth,window.innerHeight);s.setAnimationLoop($);s.xr.enabled=!0;A.appendChild(s.domElement);document.body.appendChild(X.createButton(s,{requiredFeatures:["hit-test"]}));w=s.xr.getController(0);w.addEventListener("select",V);f.add(w);const h=new K(s,g);h.listenToXRControllerEvents(w);f.add(h);u=new H(new F(.15,.2,32).rotateX(-Math.PI/2),new I);u.matrixAutoUpdate=!1;u.visible=!1;f.add(u);window.addEventListener("resize",J);let l=[],c=[],Y=["blue-bottle","green-bottle","orange-bottle"],p=!1,b=!1,k=7;function J(){g.aspect=window.innerWidth/window.innerHeight,g.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)}function Q(n){const t=new N;return t.identity().extractRotation(n.matrixWorld),R.ray.origin.setFromMatrixPosition(n.matrixWorld),R.ray.direction.set(0,0,-1).applyMatrix4(t),R.intersectObjects(h.children,!0)}function T(n,t,i){u.matrix.decompose(n.position,n.quaternion,n.scale),n.scale.set(t,t,t),n.userData.type=i;const r=n.scene||n;switch(r.scale.set(t,t,t),r.userData.type=i,h.add(r),i){case"blue-bottle":C=!0;break;case"green-bottle":O=!0;break;case"orange-bottle":W=!0;break}}function V(n){if(u.visible){let r,e,o;C?O?W||v.load("orange-bottle.glb",a=>{r=a.scene,e=.04,o="orange-bottle",T(r,e,o)}):v.load("green-bottle.glb",a=>{r=a.scene,e=40,o="green-bottle",T(r,e,o)}):v.load("blue-bottle.glb",a=>{r=a.scene,e=.1,o="blue-bottle",T(r,e,o)})}const t=n.target,i=Q(t);if(i.length>0){const e=i[0].object.parent.parent.parent.parent,o=e.scale.x;e.userData.type==="blue-bottle"?(d(e,o),b||(_(),b=!0),p||(c.push("blue-bottle"),P(c.length-1))):e.parent.userData.type==="green-bottle"?(d(e,o,1e3,100,.1),p||(c.push("green-bottle"),P(c.length-1))):e.parent.userData.type==="orange-bottle"&&(d(e,o,1e3,100,.15),p||(c.push("orange-bottle"),P(c.length-1)))}t.userData.targetRayMode=n.data.targetRayMode}function d(n,t,i=1e3,r=100,e=.02){const o=performance.now();let a=o;function L(){const y=performance.now(),S=y-o;if(S<i){if(y-a>=r){a=y;const x=t+e*Math.sin(S/1e3*r*2*Math.PI);n.scale.set(x,x,x)}requestAnimationFrame(L)}else n.scale.set(t,t,t)}L()}function q(){let n=Y[Math.floor(Math.random()*3)];l.push(n),console.log(l),Z()}function P(n){l[n]===c[n]?c.length===l.length&&(console.log("success"),c=[],l.length===k?(console.log("You win"),b=!1):setTimeout(function(){q()},3e3)):setTimeout(function(){console.log("wrong"),b=!1},200)}function Z(){p=!0,setTimeout(function(){p=!1},1e3*l.length);for(let n=0;n<l.length;n++)setTimeout(function(){let t=h.children.find(r=>r.userData.type===l[n]).children[0],i=t.scale.x;l[n]==="blue-bottle"?(t=t.parent,i=t.scale.x,d(t,i)):l[n]==="green-bottle"?d(t,i,1e3,100,.1):l[n]==="orange-bottle"&&d(t,i,1e3,100,.15)},1e3*n)}function _(){l=[],c=[],q()}function $(n,t){if(t){const i=s.xr.getReferenceSpace(),r=s.xr.getSession();if(M===!1&&(r.requestReferenceSpace("viewer").then(function(e){r.requestHitTestSource({space:e}).then(function(o){m=o})}),r.addEventListener("end",function(){M=!1,m=null}),M=!0),m){const e=t.getHitTestResults(m);if(e.length){const o=e[0];u.visible=!0,u.matrix.fromArray(o.getPose(i).transform.matrix)}else u.visible=!1}}s.render(f,g)}
//# sourceMappingURL=index-hP-IPr41.js.map
