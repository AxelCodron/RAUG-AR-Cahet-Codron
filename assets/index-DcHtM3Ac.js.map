{"version":3,"file":"index-DcHtM3Ac.js","sources":["../../src/main.js"],"sourcesContent":["import * as THREE from 'three';\r\nimport { ARButton } from 'three/addons/webxr/ARButton.js';\r\nimport { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';\r\nimport { InteractiveGroup } from 'three/addons/interactive/InteractiveGroup.js';\r\nimport { HTMLMesh } from 'three/addons/interactive/HTMLMesh.js';\r\n\r\n// ------------------------------- Setup -------------------------------\r\n\r\nlet container;\r\nlet camera, scene, renderer;\r\nlet controller;\r\nlet reticle;\r\nlet hitTestSource = null;\r\nlet hitTestSourceRequested = false;\r\nlet loadedBlueBottle, loadedGreenBottle, loadedOrangeBottle = false;\r\nlet raycaster = new THREE.Raycaster();\r\nlet displayedRules = false;\r\n\r\nconst loader = new GLTFLoader().setPath('/RAUG-AR-Cahet-Codron/assets/models/');\r\n\r\ncontainer = document.createElement('div');\r\ndocument.body.appendChild(container);\r\n\r\nscene = new THREE.Scene();\r\n\r\ncamera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 20);\r\n\r\nconst light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 3);\r\nlight.position.set(0.5, 1, 0.25);\r\nscene.add(light);\r\n\r\n// Renderer setup with WebXR and AR support\r\nrenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\nrenderer.setPixelRatio(window.devicePixelRatio);\r\nrenderer.setSize(window.innerWidth, window.innerHeight);\r\nrenderer.setAnimationLoop(animate);\r\nrenderer.xr.enabled = true;\r\ncontainer.appendChild(renderer.domElement);\r\n\r\n// Create AR button with hit-test feature\r\ndocument.body.appendChild(ARButton.createButton(renderer, { requiredFeatures: ['hit-test'] }));\r\n\r\n// AR Controller setup\r\ncontroller = renderer.xr.getController(0);\r\ncontroller.addEventListener('select', onSelect);\r\nscene.add(controller);\r\n\r\n// Interactive group setup\r\nconst interactiveBottlesGroup = new InteractiveGroup(renderer, camera);\r\ninteractiveBottlesGroup.listenToXRControllerEvents(controller);\r\nscene.add(interactiveBottlesGroup);\r\n\r\n// Reticle setup for AR placement\r\nreticle = new THREE.Mesh(\r\n  new THREE.RingGeometry(0.15, 0.2, 32).rotateX(- Math.PI / 2),\r\n  new THREE.MeshBasicMaterial()\r\n);\r\n\r\nreticle.matrixAutoUpdate = false;\r\nreticle.visible = false;\r\nscene.add(reticle);\r\n\r\n// Window resize handling\r\nwindow.addEventListener('resize', onWindowResize);\r\n\r\n// ------------------------------------- GUI -------------------------------------\r\n\r\nconst dialogs = {\r\n  'intro': {\r\n    content: `Hello scientist!</br>You must find the right combination of bottles</br>to create the remedy against the Covid 31!.</br>Begin by moving a bit to scan your surroundings.</br>When a circle appears, click on the screen to</br>place a bottle on the circle's location.`,\r\n  },\r\n  'blue-bottle': {\r\n    content: `The blue bottle is the first ingredient of</br>the remedy.</br>It's known for its calming properties.</br>Place the second bottle now!`\r\n  },\r\n  'green-bottle': {\r\n    content: `The green bottle is the second ingredient of</br>the remedy.</br>It's known for its healing properties.</br>Place the last bottle now!`\r\n  },\r\n  'orange-bottle': {\r\n    content: `The orange bottle is the last ingredient of</br>the remedy.</br>It's known for its KOOL properties.`\r\n  },\r\n  'game-description': {\r\n    content: `You have now to create the remedy!</br>Look at the bottles and remember the sequence.</br>Then, click on the bottles in the same order to</br>create the remedy!</br>Reach a sequence of 7 to win.</br>Good luck!`\r\n  },\r\n  'lose': {\r\n    content: `Game Over!</br>You have failed to create the remedy against</br>the Covid 31!</br>Humanity is doomed and the world is lost :)`\r\n  },\r\n  'win': {\r\n    content: `Congratulations!</br>You have created the remedy against the</br>Covid 31!`\r\n  },\r\n}\r\n\r\n// CrÃ©er un conteneur HTML pour l'information\r\nconst infoContainer = document.getElementById('info-container');\r\ninfoContainer.innerHTML = dialogs['intro'].content;\r\n\r\nconst mesh = new HTMLMesh(infoContainer);\r\nmesh.position.z = - 0.8;\r\n\r\ninteractiveBottlesGroup.add(mesh);\r\n\r\n// ------------------------------- Simon Game Setup -------------------------------\r\n\r\nlet gamePattern = [];\r\nlet userClickedPattern = [];\r\nlet objectsTypes = [\"blue-bottle\", \"green-bottle\", \"orange-bottle\"];\r\nlet showingSequence = false;\r\nlet gameStarted = false;\r\nlet gameRestarted = false;\r\nlet winRound = 7;\r\n\r\n// ------------------------------- Controls Functions -------------------------------\r\n\r\n/**\r\n * Handles the window resize event\r\n * @returns {void}\r\n */\r\nfunction onWindowResize() {\r\n  camera.aspect = window.innerWidth / window.innerHeight;\r\n  camera.updateProjectionMatrix();\r\n\r\n  renderer.setSize(window.innerWidth, window.innerHeight);\r\n}\r\n\r\nfunction getIntersections(controller) {\r\n  const tempMatrix = new THREE.Matrix4();\r\n\r\n  tempMatrix.identity().extractRotation(controller.matrixWorld);\r\n\r\n  raycaster.ray.origin.setFromMatrixPosition(controller.matrixWorld);\r\n  raycaster.ray.direction.set(0, 0, -1).applyMatrix4(tempMatrix);\r\n\r\n  const intersections = raycaster.intersectObjects(interactiveBottlesGroup.children, true);\r\n\r\n  return intersections;\r\n}\r\n\r\n/**\r\n * Sets up the model to be placed in the scene\r\n * @param {any} model The glb model to setup\r\n * @param {number} baseScale The original scale of the model\r\n * @param {string} modelType The name of the model\r\n * @returns {void}\r\n */\r\nfunction setupModel(model, baseScale, modelType) {\r\n  // Position and add the model\r\n  reticle.matrix.decompose(model.position, model.quaternion, model.scale);\r\n  model.scale.set(baseScale, baseScale, baseScale);\r\n  model.userData.type = modelType;\r\n\r\n  const modelToAdd = model.scene || model;\r\n  modelToAdd.scale.set(baseScale, baseScale, baseScale);\r\n  modelToAdd.userData.type = modelType;\r\n\r\n  interactiveBottlesGroup.add(modelToAdd);\r\n\r\n  switch (modelType) {\r\n    case 'blue-bottle':\r\n      loadedBlueBottle = true;\r\n      break;\r\n    case 'green-bottle':\r\n      loadedGreenBottle = true;\r\n      break;\r\n    case 'orange-bottle':\r\n      loadedOrangeBottle = true;\r\n      break;\r\n  }\r\n}\r\n\r\n/**\r\n * Main function to handle the click of a user on the AR scene\r\n * @param {Event} event The click event\r\n * @returns {void}\r\n */\r\nfunction onSelect(event) {\r\n  if (reticle.visible) {\r\n    // Load a model at the reticle position\r\n    let currentModel;\r\n    let baseScale;\r\n    let modelType;\r\n\r\n    if (!loadedBlueBottle) {\r\n      loader.load('blue-bottle.glb', (gltf) => {\r\n        currentModel = gltf.scene;\r\n        baseScale = 0.1;\r\n        modelType = 'blue-bottle';\r\n        setupModel(currentModel, baseScale, modelType);\r\n        infoContainer.innerHTML = dialogs['blue-bottle'].content;\r\n      });\r\n    } else if (!loadedGreenBottle) {\r\n      loader.load('green-bottle.glb', (gltf) => {\r\n        currentModel = gltf.scene;\r\n        baseScale = 40;\r\n        modelType = 'green-bottle';\r\n        setupModel(currentModel, baseScale, modelType);\r\n        infoContainer.innerHTML = dialogs['green-bottle'].content;\r\n      });\r\n    } else if (!loadedOrangeBottle) {\r\n      loader.load('orange-bottle.glb', (gltf) => {\r\n        currentModel = gltf.scene;\r\n        baseScale = 0.04;\r\n        modelType = 'orange-bottle';\r\n        setupModel(currentModel, baseScale, modelType);\r\n        infoContainer.innerHTML = dialogs['orange-bottle'].content;\r\n      });\r\n    }\r\n  }\r\n\r\n  if (displayedRules && gameStarted && !gameRestarted) {\r\n    const controller = event.target;\r\n    const intersections = getIntersections(controller);\r\n\r\n    if (intersections.length > 0) {\r\n      const intersection = intersections[0];\r\n\r\n      const object = intersection.object.parent.parent.parent.parent;\r\n      const objectScale = object.scale.x;\r\n\r\n      // Check the object type and apply the wiggle effect\r\n      // Also check the simon game pattern\r\n      if (object.userData.type === 'blue-bottle') {\r\n        applyWiggleEffect(object, objectScale);\r\n        if (!gameStarted) {\r\n          startOver();\r\n          gameStarted = true;\r\n        }\r\n        if (!showingSequence) {\r\n          userClickedPattern.push('blue-bottle');\r\n          checkAnswer(userClickedPattern.length - 1);\r\n        }\r\n      } else\r\n        if (object.parent.userData.type === 'green-bottle') {\r\n          applyWiggleEffect(object, objectScale, 1000, 100, 0.1);\r\n          if (!showingSequence) {\r\n            userClickedPattern.push('green-bottle');\r\n            checkAnswer(userClickedPattern.length - 1);\r\n          }\r\n        } else\r\n          if (object.parent.userData.type === 'orange-bottle') {\r\n            applyWiggleEffect(object, objectScale, 1000, 100, 0.15);\r\n            if (!showingSequence) {\r\n              userClickedPattern.push('orange-bottle');\r\n              checkAnswer(userClickedPattern.length - 1);\r\n            }\r\n          }\r\n    }\r\n  }\r\n\r\n  if (displayedRules && !gameStarted) {\r\n    infoContainer.style.display = 'none';\r\n    startOver();\r\n    gameStarted = true;\r\n  }\r\n\r\n  if (gameRestarted) {\r\n    gameRestarted = false;\r\n    gameStarted = false;\r\n  }\r\n\r\n  if (loadedOrangeBottle && !displayedRules) {\r\n    infoContainer.innerHTML = dialogs['game-description'].content;\r\n    displayedRules = true;\r\n  }\r\n\r\n  controller.userData.targetRayMode = event.data.targetRayMode;\r\n}\r\n\r\n/**\r\n * Function to apply a wiggle effect to a model\r\n * @param {any} model The model to apply the wiggle effect\r\n * @param {number} baseScale The base scale of the model\r\n * @param {number} duration The duration of the wiggle effect\r\n * @param {number} wiggleFrequency The frequency of the wiggle effect\r\n * @param {number} wiggleAmplitude The amplitude of the wiggle effect\r\n * @returns {void}\r\n */\r\nfunction applyWiggleEffect(model, baseScale, duration = 1000, wiggleFrequency = 100, wiggleAmplitude = 0.02) {\r\n  const startTime = performance.now();\r\n  let lastFrameTime = startTime;\r\n\r\n  function wiggle() {\r\n    const currentTime = performance.now();\r\n    const elapsedTime = currentTime - startTime;\r\n\r\n    if (elapsedTime < duration) {\r\n      if (currentTime - lastFrameTime >= wiggleFrequency) {\r\n        lastFrameTime = currentTime;\r\n        const scaleFactor = baseScale +\r\n          wiggleAmplitude * Math.sin((elapsedTime / 1000) * wiggleFrequency * 2 * Math.PI);\r\n        model.scale.set(scaleFactor, scaleFactor, scaleFactor);\r\n      }\r\n\r\n      requestAnimationFrame(wiggle);\r\n    } else {\r\n      model.scale.set(baseScale, baseScale, baseScale);\r\n    }\r\n  }\r\n\r\n  wiggle();\r\n}\r\n\r\n// ------------------------------- Simon Game Functions -------------------------------\r\n\r\nfunction nextSequence() {\r\n  let randomChosenObject = objectsTypes[Math.floor(Math.random() * 3)];\r\n  gamePattern.push(randomChosenObject);\r\n  console.log(gamePattern);\r\n  showSequence();\r\n}\r\n\r\nfunction checkAnswer(currentLevel) {\r\n  if (gamePattern[currentLevel] === userClickedPattern[currentLevel]) {\r\n    if (userClickedPattern.length === gamePattern.length) {\r\n      console.log(\"success\");\r\n      userClickedPattern = [];\r\n      if (gamePattern.length === winRound) {\r\n        console.log(\"You win\");\r\n        gameRestarted = true;\r\n        infoContainer.style.display = 'block';\r\n        infoContainer.innerHTML = dialogs['win'].content;\r\n      } else {\r\n        setTimeout(function () {\r\n          nextSequence();\r\n        }, 3000);\r\n      }\r\n    }\r\n  } else {\r\n    setTimeout(function () {\r\n      // GAME OVER\r\n      console.log(\"wrong\");\r\n      gameRestarted = true;\r\n      infoContainer.style.display = 'block';\r\n      infoContainer.innerHTML = dialogs['lose'].content;\r\n    }, 200);\r\n  }\r\n}\r\n\r\nfunction showSequence() {\r\n  showingSequence = true;\r\n  setTimeout(function () {\r\n    showingSequence = false;\r\n  }, 1000 * gamePattern.length);\r\n  for (let i = 0; i < gamePattern.length; i++) {\r\n    setTimeout(function () {\r\n      let object = interactiveBottlesGroup.children.find((child) => child.userData.type === gamePattern[i]).children[0];\r\n      let objectScale = object.scale.x;\r\n\r\n      if (gamePattern[i] === \"blue-bottle\") {\r\n        object = object.parent;\r\n        objectScale = object.scale.x;\r\n        applyWiggleEffect(object, objectScale);\r\n      } else if (gamePattern[i] === \"green-bottle\") {\r\n        applyWiggleEffect(object, objectScale, 1000, 100, 0.1);\r\n      } else if (gamePattern[i] === \"orange-bottle\") {\r\n        applyWiggleEffect(object, objectScale, 1000, 100, 0.15);\r\n      }\r\n    }, 1000 * i);\r\n  }\r\n}\r\n\r\nfunction startOver() {\r\n  gamePattern = [];\r\n  userClickedPattern = [];\r\n  nextSequence();\r\n}\r\n\r\n// ------------------------------- Main Loop -------------------------------\r\n\r\n/**\r\n * Main function to animate the AR scene\r\n * @param {any} timestamp \r\n * @param {any} frame \r\n */\r\nfunction animate(timestamp, frame) {\r\n  if (frame) {\r\n    const referenceSpace = renderer.xr.getReferenceSpace();\r\n    const session = renderer.xr.getSession();\r\n\r\n    if (hitTestSourceRequested === false) {\r\n      session.requestReferenceSpace('viewer').then(function (referenceSpace) {\r\n        session.requestHitTestSource({ space: referenceSpace }).then(function (source) {\r\n          hitTestSource = source;\r\n        });\r\n      });\r\n\r\n      session.addEventListener('end', function () {\r\n        hitTestSourceRequested = false;\r\n        hitTestSource = null;\r\n      });\r\n\r\n      hitTestSourceRequested = true;\r\n    }\r\n\r\n    if (hitTestSource) {\r\n      const hitTestResults = frame.getHitTestResults(hitTestSource);\r\n\r\n      if (hitTestResults.length) {\r\n        const hit = hitTestResults[0];\r\n\r\n        reticle.visible = true;\r\n        reticle.matrix.fromArray(hit.getPose(referenceSpace).transform.matrix);\r\n      } else {\r\n        reticle.visible = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  renderer.render(scene, camera);\r\n}"],"names":["container","camera","scene","renderer","controller","reticle","hitTestSource","hitTestSourceRequested","loadedBlueBottle","loadedGreenBottle","loadedOrangeBottle","raycaster","THREE.Raycaster","displayedRules","loader","GLTFLoader","THREE.Scene","THREE.PerspectiveCamera","light","THREE.HemisphereLight","THREE.WebGLRenderer","animate","ARButton","onSelect","interactiveBottlesGroup","InteractiveGroup","THREE.Mesh","THREE.RingGeometry","THREE.MeshBasicMaterial","onWindowResize","dialogs","infoContainer","mesh","HTMLMesh","gamePattern","userClickedPattern","objectsTypes","showingSequence","gameStarted","gameRestarted","winRound","getIntersections","tempMatrix","THREE.Matrix4","setupModel","model","baseScale","modelType","modelToAdd","event","currentModel","gltf","intersections","object","objectScale","applyWiggleEffect","startOver","checkAnswer","duration","wiggleFrequency","wiggleAmplitude","startTime","lastFrameTime","wiggle","currentTime","elapsedTime","scaleFactor","nextSequence","randomChosenObject","showSequence","currentLevel","i","child","timestamp","frame","referenceSpace","session","source","hitTestResults","hit"],"mappings":"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"}